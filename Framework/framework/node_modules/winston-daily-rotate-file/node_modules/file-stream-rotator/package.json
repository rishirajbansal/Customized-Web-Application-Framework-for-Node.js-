{
  "name": "file-stream-rotator",
  "version": "0.2.1",
  "description": "Automated stream rotation useful for log files",
  "main": "FileStreamRotator.js",
  "scripts": {
    "test": "node test.js"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/rogerc/file-stream-rotator.git"
  },
  "keywords": [
    "stream",
    "express",
    "restify",
    "connect",
    "rotate",
    "file",
    "minute",
    "hourly",
    "daily",
    "logrotate"
  ],
  "author": {
    "name": "Roger Castells"
  },
  "license": "MIT",
  "dependencies": {
    "moment": "^2.11.2"
  },
  "readme": "\nfile-stream-rotator\n===================\n\nNodeJS file stream rotator\n\n## Purpose\n\nTo provide an automated rotation of Express/Connect logs or anything else that writes to a log on a regular basis that needs to be rotated based on date. It can also be rotated based on a size limit and remove old log files based on count or elapsed days. \n\n## Install\n\n```\nnpm install file-stream-rotator\n```\n\n## Options\n\n - *filename*:       Filename including full path used by the stream\n - *frequency*:      How often to rotate. Options are 'daily', 'custom' and 'test'. 'test' rotates every minute.\n                     If frequency is set to none of the above, a YYYYMMDD string will be added to the end of the filename.\n - *verbose*:        If set, it will log to STDOUT when it rotates files and name of log file. Default is TRUE.\n - *date_format*:    Format as used in moment.js http://momentjs.com/docs/#/displaying/format/. The result is used to replace\n                     the '%DATE%' placeholder in the filename.\n                     If using 'custom' frequency, it is used to trigger file rotation when the string representation changes.\n - *size*:           Max size of the file after which it will rotate. It can be combined with frequency or date format.\n                     The size units are 'k', 'm' and 'g'. Units need to directly follow a number e.g. 1g, 100m, 20k.\n - *max_logs*        Max number of logs to keep. If not set, it won't remove past logs. It uses its own log audit file\n                     to keep track of the log files in a json format. It won't delete any file not contained in it.\n                     It can be a number of files or number of days. If using days, add 'd' as the suffix.\n\n - *audit_file*      Location to store the log audit file. If not set, it will be stored in the root of the application.\n\n## Example Usage\n```javascript\n    // Default date added at the end of the file\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test.log\", frequency:\"daily\", verbose: false});\n \n    // Default date added using file pattern\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test-%DATE%.log\", frequency:\"daily\", verbose: false});\n \n    // Custom date added using file pattern using moment.js formats\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test-%DATE%.log\", frequency:\"daily\", verbose: false, date_format: \"YYYY-MM-DD\"});\n \n    // Rotate when the date format as calculated by momentjs is different (e.g monthly)\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test-%DATE%.log\", frequency:\"custom\", verbose: false, date_format: \"YYYY-MM\"});\n \n    // Rotate when the date format as calculated by momentjs is different (e.g weekly)\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test-%DATE%.log\", frequency:\"custom\", verbose: false, date_format: \"YYYY-ww\"});\n \n    // Rotate when the date format as calculated by momentjs is different (e.g AM/PM)\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test-%DATE%.log\", frequency:\"custom\", verbose: false, date_format: \"YYYY-MM-DD-A\"});\n \n    // Rotate on given minutes using the 'm' option i.e. 5m or 30m\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test.log\", frequency:\"5m\", verbose: false});\n     \n    // Rotate on the hour or any specified number of hours\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test.log\", frequency:\"1h\", verbose: false});\n\n    // Rotate on the hour or any specified number of hours and keep 10 files\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test.log\", frequency:\"1h\", verbose: false, max_logs: 10});\n\n    // Rotate on the hour or any specified number of hours and keep 10 days\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test.log\", frequency:\"1h\", verbose: false, max_logs: \"10d\"});\n\n    // Rotate on the hour or any specified number of hours and keep 10 days and store the audit file in /tmp/log-audit.json\n    var rotatingLogStream = require('file-stream-rotator').getStream({filename:\"/tmp/test.log\", frequency:\"1h\", verbose: false, max_logs: \"10d\", audit_file: \"/tmp/log-audit.json\"});\n\n    //.....    \n    \n    // Use new stream in express\n    app.use(express.logger({stream: rotatingLogStream, format: \"default\"}));\n    \n    //.....\n\n```\n    \nYou can listen to the *open*, *close*, *error* and *finish* events generated by the open stream. You can also listen for custom events:\n\n  * *rotate*: that will pass two parameters to the callback: (*oldFilename*, *newFilename*)\n  * *new*: that will pass one parameter to the callback: *newFilename*\n  \nYou can also limit the size of each file by adding the size option using \"k\", \"m\" and \"g\" to specify the size of the file in kiloybytes, megabytes or gigabytes. When it rotates a file based on size, it will add a number to the end and increment it for every time the file rotates in the given period as shown below.\n  \n```\n  3078  7 Mar 13:09:58 2017 testlog-2017-03-07.13.09.log.20\n  2052  7 Mar 13:10:00 2017 testlog-2017-03-07.13.09.log.21\n  3078  7 Mar 13:10:05 2017 testlog-2017-03-07.13.10.log.1\n  3078  7 Mar 13:10:08 2017 testlog-2017-03-07.13.10.log.2\n  3078  7 Mar 13:10:11 2017 testlog-2017-03-07.13.10.log.3\n  3078  7 Mar 13:10:14 2017 testlog-2017-03-07.13.10.log.4\n```  \n\n  The example below will rotate files daily but each file will be limited to 5MB.\n  \n```javascript\n    // Rotate every day or every 5 megabytes, whatever comes first.\n    var rotatingLogStream = require('file-stream-rotator').getStream(\n        {\n            filename:\"/tmp/test-%DATE%.log\", \n            frequency:\"custom\", \n            verbose: false, \n            date_format: \"YYYY-MM-DD\",\n            size: \"5M\" // its letter denominating the size is case insensitive\n        }\n    );\n    rotatingLogStream.on('rotate',function(oldFile,newFile){\n        // do something with old file like compression or delete older than X days.\n    })\n```\n\n## NPM Maintainers\n\nThe npm module for this library will be maintained by:\n\n* [Roger C](http://github.com/rogerc)\n\n## License\n\nfile-stream-rotator is licensed under the MIT license.\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/rogerc/file-stream-rotator/issues"
  },
  "homepage": "https://github.com/rogerc/file-stream-rotator",
  "_id": "file-stream-rotator@0.2.1",
  "_from": "file-stream-rotator@^0.2.1"
}
